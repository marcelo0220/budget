<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Budget Pro</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box}

:root{
--primary:linear-gradient(135deg,#1a237e,#3f51b5);
--accent:#ffd700;
--glass:rgba(255,255,255,.1);
--shadow:0 20px 40px rgba(0,0,0,.2)
}

body{
font-family:Inter,sans-serif;
background:linear-gradient(135deg,#0a0e27,#1a237e);
color:#fff;
min-height:100vh
}

body.light{
background:linear-gradient(135deg,#e3f2fd,#bbdefb);
color:#1a237e
}

.container{max-width:1200px;margin:auto;padding:20px}

header{
display:flex;
justify-content:space-between;
align-items:center;
margin-bottom:30px
}

h1{
font-size:28px;
font-weight:700;
background:linear-gradient(135deg,#fff,var(--accent));
-webkit-background-clip:text;
-webkit-text-fill-color:transparent
}

.theme-toggle{
width:50px;height:50px;
border-radius:50%;
background:var(--glass);
border:1px solid rgba(255,255,255,.2);
cursor:pointer;
font-size:20px
}

.balance-card{
background:var(--glass);
backdrop-filter:blur(20px);
border-radius:24px;
padding:30px;
margin-bottom:25px;
border:1px solid rgba(255,255,255,.2)
}

.balance-label{opacity:.7;font-weight:600}
.balance-amount{
font-size:46px;
font-weight:700;
margin:10px 0;
background:linear-gradient(135deg,#fff,var(--accent));
-webkit-background-clip:text;
-webkit-text-fill-color:transparent
}

.stats-grid{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(150px,1fr));
gap:15px;
margin-bottom:25px
}

.stat-card{
background:var(--glass);
padding:20px;
border-radius:16px;
border:1px solid rgba(255,255,255,.2)
}

.stat-label{opacity:.7;font-size:13px}
.stat-value{font-size:22px;font-weight:600}
.positive{color:#4ecdc4}
.negative{color:#ff6b6b}

.actions{display:flex;gap:15px;margin-bottom:20px}

.btn{
flex:1;
padding:14px;
border:none;
border-radius:14px;
font-weight:600;
cursor:pointer
}

.btn-primary{background:var(--primary);color:#fff}
.btn-secondary{
background:var(--glass);
border:1px solid rgba(255,255,255,.2);
color:#fff
}

.search-box{
width:100%;
padding:14px;
border-radius:14px;
border:1px solid rgba(255,255,255,.2);
background:var(--glass);
color:#fff;
margin-bottom:20px
}

.transactions{
background:var(--glass);
padding:25px;
border-radius:24px;
border:1px solid rgba(255,255,255,.2)
}

.transaction-item{
display:flex;
justify-content:space-between;
align-items:center;
padding:16px;
border-radius:12px;
margin-bottom:10px;
background:rgba(255,255,255,.05);
cursor:pointer
}

.transaction-info{display:flex;gap:12px;align-items:center}
.transaction-icon{
width:44px;height:44px;
border-radius:12px;
display:flex;
align-items:center;
justify-content:center;
font-size:22px
}

.transaction-amount{font-size:18px;font-weight:600}

.modal{
display:none;
position:fixed;
inset:0;
background:rgba(0,0,0,.8);
backdrop-filter:blur(10px);
align-items:flex-end
}

.modal-content{
background:#fff;
color:#1a237e;
width:100%;
max-width:600px;
margin:auto;
border-radius:24px 24px 0 0;
padding:30px
}

.form-group{margin-bottom:18px}
.form-group label{font-weight:600;font-size:14px}
.form-group input,.form-group select{
width:100%;
padding:12px;
border-radius:12px;
border:2px solid rgba(26,35,126,.2)
}

.category-grid{
display:grid;
grid-template-columns:repeat(4,1fr);
gap:10px;
margin-top:10px
}

.category-btn{
padding:12px;
border-radius:12px;
border:2px solid rgba(26,35,126,.2);
cursor:pointer;
font-size:22px
}

.category-btn.active{
border-color:#3f51b5;
background:rgba(63,81,181,.15)
}

.toast{
position:fixed;
bottom:30px;
right:30px;
background:var(--glass);
padding:18px 24px;
border-radius:16px;
border:1px solid rgba(255,255,255,.2)
}
</style>
</head>

<body>
<div class="container">

<header>
<h1>Budget Pro</h1>
<button class="theme-toggle" onclick="toggleTheme()">ðŸŒ™</button>
</header>

<!-- SOLDE -->
<div class="balance-card">
<div class="balance-label">Solde actuel</div>
<div class="balance-amount" id="balance">0 Ar</div>
</div>

<!-- Ã‰PARGNE (NOUVELLE FONCTIONNALITÃ‰) -->
<div class="balance-card">
<div class="balance-label">ðŸ’° Ã‰pargne automatique</div>
<div class="balance-amount" id="savings">0 Ar</div>
<div class="balance-label">10 % de chaque revenu est Ã©pargnÃ©</div>
</div>

<!-- STATS -->
<div class="stats-grid">
<div class="stat-card"><div class="stat-label">Revenus</div><div class="stat-value positive" id="income">0 Ar</div></div>
<div class="stat-card"><div class="stat-label">DÃ©penses</div><div class="stat-value negative" id="expenses">0 Ar</div></div>
<div class="stat-card"><div class="stat-label">Transactions</div><div class="stat-value" id="count">0</div></div>
</div>

<div class="actions">
<button class="btn btn-primary" onclick="openModal()">âž• Ajouter</button>
<button class="btn btn-secondary" onclick="exportData()">ðŸ“Š Export</button>
</div>

<input class="search-box" placeholder="ðŸ” Rechercher..." id="search" oninput="renderTransactions()">

<div class="transactions">
<h3>Transactions rÃ©centes</h3>
<div id="transactionsList"></div>
</div>

</div>

<!-- MODAL -->
<div class="modal" id="modal">
<div class="modal-content">
<h2>Nouvelle transaction</h2>
<form onsubmit="addTransaction(event)">
<div class="form-group">
<label>Type</label>
<select id="type" onchange="updateCategories()">
<option value="expense">DÃ©pense</option>
<option value="income">Revenu</option>
</select>
</div>

<div class="form-group">
<label>Montant (Ar)</label>
<input type="number" id="amount" required>
</div>

<div class="form-group">
<label>Description</label>
<input type="text" id="description" required>
</div>

<div class="form-group">
<label>CatÃ©gorie</label>
<div class="category-grid" id="categories"></div>
</div>

<div style="display:flex;gap:15px">
<button class="btn btn-primary">Valider</button>
<button type="button" class="btn btn-secondary" onclick="closeModal()">Annuler</button>
</div>
</form>
</div>
</div>

<script>
const categories={
expense:[
{icon:'ðŸ”',name:'Nourriture',color:'#ff6b6b'},
{icon:'ðŸš—',name:'Transport',color:'#4ecdc4'},
{icon:'ðŸ ',name:'Logement',color:'#95e1d3'}
],
income:[
{icon:'ðŸ’°',name:'Salaire',color:'#4ecdc4'},
{icon:'ðŸ“ˆ',name:'Business',color:'#ffd93d'}
]
};

let transactions=JSON.parse(localStorage.getItem('transactions')||'[]');
let savings=parseFloat(localStorage.getItem('savings')||'0');
let selectedCategory=null;

function formatAr(v){return new Intl.NumberFormat('fr-FR').format(v)+' Ar'}

function updateCategories(){
const type=document.getElementById('type').value;
const grid=document.getElementById('categories');
grid.innerHTML=categories[type].map((c,i)=>
`<div class="category-btn" onclick="selectCategory(${i})">${c.icon}</div>`).join('');
selectedCategory=null;
}

function selectCategory(i){
document.querySelectorAll('.category-btn').forEach(b=>b.classList.remove('active'));
document.querySelectorAll('.category-btn')[i].classList.add('active');
selectedCategory=i;
}

function addTransaction(e){
e.preventDefault();
const type=document.getElementById('type').value;
const amount=Number(document.getElementById('amount').value);
const desc=document.getElementById('description').value;

if(selectedCategory===null){alert('Choisissez une catÃ©gorie');return;}

const cat=categories[type][selectedCategory];
const value=type==='expense'?-amount:amount;

transactions.unshift({
id:Date.now(),
amount:value,
description:desc,
icon:cat.icon,
category:cat.name,
color:cat.color,
date:new Date()
});

if(type==='income'){
const saved=amount*0.1;
savings+=saved;
localStorage.setItem('savings',savings);
}

localStorage.setItem('transactions',JSON.stringify(transactions));
closeModal();
renderTransactions();
updateStats();
}

function renderTransactions(){
const s=document.getElementById('search').value.toLowerCase();
const list=document.getElementById('transactionsList');
list.innerHTML=transactions
.filter(t=>t.description.toLowerCase().includes(s))
.map(t=>`
<div class="transaction-item" onclick="deleteTransaction(${t.id})">
<div class="transaction-info">
<div class="transaction-icon" style="background:${t.color}20">${t.icon}</div>
<div>${t.description}<br><small>${new Date(t.date).toLocaleDateString()}</small></div>
</div>
<div class="transaction-amount" style="color:${t.amount>0?'#4ecdc4':'#ff6b6b'}">
${t.amount>0?'+':''}${formatAr(Math.abs(t.amount))}
</div>
</div>`).join('')||'<p>Aucune transaction</p>';
}

function updateStats(){
const balance=transactions.reduce((s,t)=>s+t.amount,0);
const income=transactions.filter(t=>t.amount>0).reduce((s,t)=>s+t.amount,0);
const expenses=Math.abs(transactions.filter(t=>t.amount<0).reduce((s,t)=>s+t.amount,0));

balanceEl.textContent=formatAr(balance);
incomeEl.textContent=formatAr(income);
expensesEl.textContent=formatAr(expenses);
countEl.textContent=transactions.length;
savingsEl.textContent=formatAr(savings);
}

function deleteTransaction(id){
if(confirm('Supprimer ?')){
transactions=transactions.filter(t=>t.id!==id);
localStorage.setItem('transactions',JSON.stringify(transactions));
renderTransactions();updateStats();
}
}

function openModal(){modal.style.display='flex';updateCategories()}
function closeModal(){modal.style.display='none'}

function toggleTheme(){
document.body.classList.toggle('light');
}

function exportData(){
const blob=new Blob([JSON.stringify(transactions,null,2)],{type:'application/json'});
const a=document.createElement('a');
a.href=URL.createObjectURL(blob);
a.download='budget.json';
a.click();
}

const balanceEl=document.getElementById('balance');
const incomeEl=document.getElementById('income');
const expensesEl=document.getElementById('expenses');
const countEl=document.getElementById('count');
const savingsEl=document.getElementById('savings');
const modal=document.getElementById('modal');

renderTransactions();
updateStats();
</script>

</body>
</html>