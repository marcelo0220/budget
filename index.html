<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Budget Pro AI+ ‚Äì Cat√©gories Dynamiques</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:Inter;background:#0a0e17;color:#fff}
.container{max-width:1200px;margin:auto;padding:20px}
h1{margin-bottom:16px}
.card{background:rgba(255,255,255,.08);border-radius:16px;padding:20px;margin-bottom:20px}
button{cursor:pointer;border:none;border-radius:10px;padding:12px 16px;font-weight:600}
.btn{background:#3f51b5;color:#fff}
input{padding:10px;border-radius:8px;border:none;width:100%}
.flex{display:flex;gap:12px;flex-wrap:wrap}
.category{padding:10px;border-radius:10px;background:rgba(255,255,255,.1)}
.ok{color:#4ecdc4}
.warn{color:#ffd93d}
.danger{color:#ff6b6b}
.progress{height:6px;background:#333;border-radius:3px;overflow:hidden}
.progress div{height:100%}
</style>
</head>

<body>
<div class="container">

<h1>üí∞ Budget Pro AI+</h1>

<!-- CONFIG -->
<div class="card">
<h3>‚öôÔ∏è Configuration</h3>
<input id="monthlyBudget" type="number" placeholder="Budget mensuel (Ar)">
</div>

<!-- ADD CATEGORY -->
<div class="card">
<h3>‚ûï Ajouter une cat√©gorie</h3>
<div class="flex">
<input id="catName" placeholder="Nom (ex: √âducation)">
<input id="catIcon" placeholder="Emoji üìö">
<input id="catBudget" type="number" placeholder="Budget (Ar)">
<button class="btn" onclick="addCategory()">Ajouter</button>
</div>
</div>

<!-- ADD TRANSACTION -->
<div class="card">
<h3>‚ûï Transaction</h3>
<div class="flex">
<input id="desc" placeholder="Description">
<input id="amount" type="number" placeholder="Montant">
<select id="catSelect"></select>
<button class="btn" onclick="addTransaction()">OK</button>
</div>
</div>

<!-- BUDGET STATUS -->
<div class="card">
<h3>üìä Budgets & alertes</h3>
<div id="budgetList"></div>
</div>

<!-- CHART -->
<div class="card">
<canvas id="chart"></canvas>
</div>

</div>

<script>
let categories = JSON.parse(localStorage.getItem("cats")) || [
 {name:"Nourriture",icon:"üçî",budget:0},
 {name:"Transport",icon:"üöó",budget:0}
];
let transactions = JSON.parse(localStorage.getItem("tx")) || [];

function save(){
 localStorage.setItem("cats",JSON.stringify(categories));
 localStorage.setItem("tx",JSON.stringify(transactions));
}

function addCategory(){
 const name=catName.value.trim();
 if(!name)return;
 categories.push({
  name,
  icon:catIcon.value||"üì¶",
  budget:Number(catBudget.value)||0
 });
 save();render();
}

function addTransaction(){
 const val=Number(amount.value);
 transactions.push({
  desc:desc.value,
  amount:-Math.abs(val),
  cat:catSelect.value
 });
 save();render();
}

function totalSpent(cat){
 return Math.abs(transactions.filter(t=>t.cat===cat).reduce((s,t)=>s+t.amount,0));
}

function render(){
 catSelect.innerHTML=categories.map(c=>`<option>${c.name}</option>`).join("");

 budgetList.innerHTML=categories.map(c=>{
  const spent=totalSpent(c.name);
  const pct=c.budget?spent/c.budget*100:0;
  let cls="ok"; if(pct>100)cls="danger"; else if(pct>75)cls="warn";
  return `
  <div class="category">
   ${c.icon} <b>${c.name}</b><br>
   ${spent.toLocaleString()} / ${c.budget.toLocaleString()} Ar
   <span class="${cls}"> (${Math.round(pct)}%)</span>
   <div class="progress"><div style="width:${Math.min(pct,100)}%;background:${cls=='danger'?'#ff6b6b':cls=='warn'?'#ffd93d':'#4ecdc4'}"></div></div>
  </div>`;
 }).join("");

 drawChart();
}

let chart;
function drawChart(){
 const data={};
 transactions.forEach(t=>data[t.cat]=(data[t.cat]||0)+Math.abs(t.amount));
 if(chart)chart.destroy();
 chart=new Chart(document.getElementById("chart"),{
  type:"doughnut",
  data:{labels:Object.keys(data),datasets:[{data:Object.values(data)}]}
 });
}

render();
</script>
</body>
</html>
