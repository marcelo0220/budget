<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Budget Pro AI+ ‚úÖ</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
/* === DESIGN STRICTEMENT IDENTIQUE √Ä TON CODE === */
*{margin:0;padding:0;box-sizing:border-box}
:root{--primary:#3f51b5;--accent:#ffd700;--glass:rgba(255,255,255,0.1);--success:#4ecdc4;--warning:#ff6b6b;--danger:#ef4444;--bg-dark:linear-gradient(135deg,#0a0e17,#1a237e);--radius:16px}
body{font-family:'Inter',sans-serif;background:var(--bg-dark);color:#fff;min-height:100vh}
.container{max-width:1200px;margin:auto;padding:20px}
h1{font-size:28px;font-weight:700}
.balance-card,.transactions,.chart-container{background:var(--glass);border-radius:20px;padding:24px;margin-bottom:20px;border:1px solid rgba(255,255,255,.15)}
.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:16px}
.stat-card{text-align:center}
.balance-amount{font-size:26px;font-weight:700}
.actions{display:flex;gap:12px;margin:20px 0;flex-wrap:wrap}
.btn{padding:14px;border-radius:14px;border:none;font-weight:600;cursor:pointer}
.btn-primary{background:var(--primary);color:#fff}
.btn-secondary{background:var(--glass);border:2px solid rgba(255,255,255,.3);color:#fff}
.transaction-item{display:flex;justify-content:space-between;align-items:center;padding:14px;margin-bottom:10px;border-radius:12px;background:rgba(255,255,255,.08);cursor:pointer}
.positive{color:var(--success)}
.negative{color:var(--warning)}
.suggestion-item{display:flex;justify-content:space-between;align-items:center;padding:14px;border-bottom:1px solid rgba(255,255,255,.1)}
.progress-bar{width:80px;height:6px;background:rgba(255,255,255,.2);border-radius:3px;overflow:hidden}
.progress-fill{height:100%}
.progress-ok{background:var(--success)}
.progress-warning{background:var(--warning)}
.progress-danger{background:var(--danger)}
.budget-ok{border-left:4px solid var(--success)}
.budget-warning{border-left:4px solid var(--warning)}
.budget-danger{border-left:4px solid var(--danger)}
</style>
</head>

<body>
<div class="container">
<h1>üèõ Budget Pro AI+</h1>

<div class="balance-card">
<label>Budget mensuel</label>
<input id="monthlyBudget" type="number" placeholder="500000" oninput="saveConfig()">
</div>

<div class="stats-grid">
<div class="stat-card"><div>Budget</div><div class="balance-amount" id="totalBudget">0</div></div>
<div class="stat-card"><div>Solde</div><div class="balance-amount" id="balance">0</div></div>
<div class="stat-card"><div>√âpargne</div><div class="balance-amount" id="savings">0</div></div>
</div>

<div class="actions">
<button class="btn btn-primary" onclick="openModal()">‚ûï Transaction</button>
<button class="btn btn-secondary" onclick="resetData()">üßπ Reset</button>
</div>

<div class="chart-container">
<canvas id="expensesChart"></canvas>
</div>

<div class="balance-card">
<h3>üí° Budgets & alertes</h3>
<div id="suggestionList"></div>
</div>

<div class="transactions">
<h3>üìã Transactions</h3>
<div id="transactionsList"></div>
</div>
</div>

<script>
/* === DONN√âES === */
let transactions = JSON.parse(localStorage.getItem("tx")||"[]");
let monthlyBudget = Number(localStorage.getItem("budget")||0);
let savings = Number(localStorage.getItem("savings")||0);
let customBudget = JSON.parse(localStorage.getItem("customBudget")||"{}");

/* === CAT√âGORIES √âTENDUES === */
const categories = [
 {name:"Nourriture",icon:"üçî"},
 {name:"Transport",icon:"üöó"},
 {name:"Logement",icon:"üè†"},
 {name:"Internet",icon:"üì±"},
 {name:"√ânergie",icon:"üí°"},
 {name:"Sant√©",icon:"‚ù§Ô∏è"},
 {name:"√âducation",icon:"üìö"},
 {name:"Imp√¥ts",icon:"üßæ"},
 {name:"Loisirs",icon:"üéâ"},
 {name:"Divers",icon:"üõí"}
];

/* === UTILS === */
const f=v=>new Intl.NumberFormat('fr-FR').format(v)+" Ar";

function saveConfig(){
 monthlyBudget=Number(monthlyBudgetInput.value)||0;
 localStorage.setItem("budget",monthlyBudget);
 render();
}

function spent(cat){
 return Math.abs(transactions.filter(t=>t.cat===cat).reduce((s,t)=>s+t.amount,0));
}

/* === RENDER === */
function render(){
 totalBudget.textContent=f(monthlyBudget);
 const bal=transactions.reduce((s,t)=>s+t.amount,0);
 balance.textContent=f(bal);
 savingsEl.textContent=f(savings);

 transactionsList.innerHTML=transactions.map(t=>
 `<div class="transaction-item">
  <div>${t.desc} ¬∑ ${t.cat}</div>
  <div class="${t.amount>0?'positive':'negative'}">${f(t.amount)}</div>
 </div>`).join("");

 suggestionList.innerHTML=categories.map(c=>{
  const b=customBudget[c.name]??Math.round(monthlyBudget/10);
  const s=spent(c.name);
  const p=b?Math.round(s/b*100):0;
  let cls="budget-ok",bar="progress-ok";
  if(p>100){cls="budget-danger";bar="progress-danger"}
  else if(p>75){cls="budget-warning";bar="progress-warning"}

  return `<div class="suggestion-item ${cls}">
   <div>${c.icon} ${c.name}<br><small>${f(s)} / ${f(b)}</small></div>
   <div>
    <input type="number" value="${b}" onchange="customBudget['${c.name}']=this.value;localStorage.setItem('customBudget',JSON.stringify(customBudget));render()">
    <div class="progress-bar"><div class="progress-fill ${bar}" style="width:${Math.min(p,100)}%"></div></div>
   </div>
  </div>`;
 }).join("");

 drawChart();
}

/* === CHART === */
let chart;
function drawChart(){
 const data={};
 transactions.forEach(t=>data[t.cat]=(data[t.cat]||0)+Math.abs(t.amount));
 if(chart)chart.destroy();
 chart=new Chart(expensesChart,{
  type:"doughnut",
  data:{labels:Object.keys(data),datasets:[{data:Object.values(data)}]},
  options:{plugins:{legend:{position:'bottom'}}}
 });
}

/* === INIT === */
monthlyBudgetInput.value=monthlyBudget;
render();
</script>
</body>
</html>
